  0%|                                                                                                          | 0/1310 [00:00<?, ?it/s]/home/elicer/.local/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  0%|                                                                                                | 1/1310 [00:17<6:14:29, 17.17s/it]
{'loss': 0.6436, 'learning_rate': 4.000000000000001e-06, 'epoch': 0.01}


  0%|▏                                                                                               | 3/1310 [00:45<5:26:31, 14.99s/it]
{'loss': 0.6066, 'learning_rate': 1.2e-05, 'epoch': 0.02}


  0%|▎                                                                                               | 5/1310 [01:09<4:46:23, 13.17s/it]

  0%|▍                                                                                               | 6/1310 [01:23<4:49:59, 13.34s/it]

  1%|▌                                                                                               | 7/1310 [01:43<5:39:02, 15.61s/it]

  1%|▌                                                                                               | 8/1310 [02:01<5:55:09, 16.37s/it]
{'loss': 0.6447, 'learning_rate': 3.2000000000000005e-05, 'epoch': 0.06}

  1%|▋                                                                                               | 9/1310 [02:16<5:46:12, 15.97s/it]

  1%|▋                                                                                              | 10/1310 [02:27<5:08:16, 14.23s/it]











 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]


  1%|▊                                                                                              | 11/1310 [03:14<8:46:17, 24.31s/it]

  1%|▊                                                                                              | 12/1310 [03:29<7:47:34, 21.61s/it]
{'loss': 0.673, 'learning_rate': 4.8e-05, 'epoch': 0.09}


  1%|█                                                                                              | 14/1310 [04:05<7:20:18, 20.38s/it]
{'loss': 0.6276, 'learning_rate': 5.6000000000000006e-05, 'epoch': 0.11}


  1%|█▏                                                                                             | 16/1310 [04:39<6:32:47, 18.21s/it]

  1%|█▏                                                                                             | 17/1310 [04:55<6:18:59, 17.59s/it]

  1%|█▎                                                                                             | 18/1310 [05:10<6:00:08, 16.73s/it]

  1%|█▍                                                                                             | 19/1310 [05:29<6:17:00, 17.52s/it]

  2%|█▍                                                                                             | 20/1310 [05:52<6:47:04, 18.93s/it]
{'loss': 0.6029, 'learning_rate': 8e-05, 'epoch': 0.15}











 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]

  2%|█▌                                                                                             | 21/1310 [06:34<9:14:45, 25.82s/it]

  2%|█▌                                                                                             | 22/1310 [06:50<8:11:14, 22.88s/it]
{'loss': 0.5607, 'learning_rate': 8.800000000000001e-05, 'epoch': 0.17}


  2%|█▋                                                                                             | 24/1310 [07:26<7:07:24, 19.94s/it]

  2%|█▊                                                                                             | 25/1310 [07:38<6:19:20, 17.71s/it]

  2%|█▉                                                                                             | 26/1310 [07:48<5:28:00, 15.33s/it]

  2%|█▉                                                                                             | 27/1310 [08:08<6:01:18, 16.90s/it]
{'loss': 0.5832, 'learning_rate': 0.00010800000000000001, 'epoch': 0.21}


  2%|██                                                                                             | 29/1310 [08:35<5:20:22, 15.01s/it]

  2%|██▏                                                                                            | 30/1310 [08:48<5:08:36, 14.47s/it]
{'loss': 0.5698, 'learning_rate': 0.00012, 'epoch': 0.23}











 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]

  2%|██▏                                                                                            | 31/1310 [09:30<8:06:47, 22.84s/it]

  2%|██▎                                                                                            | 32/1310 [09:44<7:06:16, 20.01s/it]
{'loss': 0.6109, 'learning_rate': 0.00012800000000000002, 'epoch': 0.24}


  3%|██▍                                                                                            | 34/1310 [10:16<6:22:33, 17.99s/it]

  3%|██▌                                                                                            | 35/1310 [10:28<5:41:50, 16.09s/it]
{'loss': 0.6591, 'learning_rate': 0.00014, 'epoch': 0.27}

  3%|██▌                                                                                            | 36/1310 [10:43<5:35:47, 15.81s/it]


  3%|██▊                                                                                            | 38/1310 [11:17<5:43:16, 16.19s/it]

  3%|██▊                                                                                            | 39/1310 [11:36<6:01:56, 17.09s/it]
{'loss': 0.5512, 'learning_rate': 0.00015600000000000002, 'epoch': 0.3}

  3%|██▉                                                                                            | 40/1310 [11:47<5:26:32, 15.43s/it]









 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]


  3%|██▉                                                                                            | 41/1310 [12:26<7:54:48, 22.45s/it]

  3%|███                                                                                            | 42/1310 [12:40<7:00:49, 19.91s/it]

  3%|███                                                                                            | 43/1310 [12:55<6:28:31, 18.40s/it]
{'loss': 0.5752, 'learning_rate': 0.000172, 'epoch': 0.33}


  3%|███▎                                                                                           | 45/1310 [13:18<5:19:10, 15.14s/it]

  4%|███▎                                                                                           | 46/1310 [13:34<5:22:30, 15.31s/it]

  4%|███▍                                                                                           | 47/1310 [13:52<5:39:26, 16.13s/it]

  4%|███▍                                                                                           | 48/1310 [14:09<5:41:58, 16.26s/it]

  4%|███▌                                                                                           | 49/1310 [14:27<5:53:40, 16.83s/it]

  4%|███▋                                                                                           | 50/1310 [14:47<6:12:11, 17.72s/it]
{'loss': 0.5998, 'learning_rate': 0.0002, 'epoch': 0.38}











 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]

  4%|███▋                                                                                           | 51/1310 [15:33<9:12:59, 26.35s/it]

  4%|███▊                                                                                           | 52/1310 [15:48<7:58:50, 22.84s/it]

  4%|███▊                                                                                           | 53/1310 [16:02<7:06:45, 20.37s/it]

  4%|███▉                                                                                           | 54/1310 [16:17<6:30:03, 18.63s/it]

  4%|███▉                                                                                           | 55/1310 [16:32<6:06:08, 17.50s/it]

  4%|████                                                                                           | 56/1310 [16:42<5:21:58, 15.41s/it]

  4%|████▏                                                                                          | 57/1310 [16:54<4:57:04, 14.23s/it]

  4%|████▏                                                                                          | 58/1310 [17:06<4:43:23, 13.58s/it]

  5%|████▎                                                                                          | 59/1310 [17:19<4:39:49, 13.42s/it]

  5%|████▎                                                                                          | 60/1310 [17:30<4:27:15, 12.83s/it]
{'loss': 0.5596, 'learning_rate': 0.00024, 'epoch': 0.46}











 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]

  5%|████▍                                                                                          | 61/1310 [18:09<7:10:03, 20.66s/it]

  5%|████▍                                                                                          | 62/1310 [18:26<6:47:12, 19.58s/it]

  5%|████▌                                                                                          | 63/1310 [18:39<6:03:57, 17.51s/it]
{'loss': 0.5539, 'learning_rate': 0.000252, 'epoch': 0.48}


  5%|████▋                                                                                          | 65/1310 [19:31<7:26:32, 21.52s/it]

  5%|████▊                                                                                          | 66/1310 [19:43<6:24:18, 18.54s/it]

  5%|████▊                                                                                          | 67/1310 [20:03<6:30:33, 18.85s/it]

  5%|████▉                                                                                          | 68/1310 [20:24<6:43:38, 19.50s/it]

  5%|█████                                                                                          | 69/1310 [20:43<6:44:34, 19.56s/it]
{'loss': 0.524, 'learning_rate': 0.000276, 'epoch': 0.53}

  5%|█████                                                                                          | 70/1310 [21:00<6:25:34, 18.66s/it]








 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]


  5%|█████▏                                                                                         | 71/1310 [21:47<9:23:44, 27.30s/it]

  5%|█████▏                                                                                         | 72/1310 [22:14<9:20:01, 27.14s/it]

  6%|█████▎                                                                                         | 73/1310 [22:28<7:54:43, 23.03s/it]

  6%|█████▎                                                                                         | 74/1310 [22:48<7:39:22, 22.30s/it]

  6%|█████▍                                                                                         | 75/1310 [23:02<6:43:57, 19.63s/it]

  6%|█████▌                                                                                         | 76/1310 [23:14<5:56:55, 17.35s/it]

  6%|█████▌                                                                                         | 77/1310 [23:27<5:32:28, 16.18s/it]

  6%|█████▋                                                                                         | 78/1310 [23:58<7:05:31, 20.72s/it]

  6%|█████▋                                                                                         | 79/1310 [24:13<6:24:51, 18.76s/it]

  6%|█████▊                                                                                         | 80/1310 [24:23<5:31:43, 16.18s/it]
{'loss': 0.5591, 'learning_rate': 0.00032, 'epoch': 0.61}











 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]

  6%|█████▊                                                                                         | 81/1310 [25:02<7:56:26, 23.26s/it]

  6%|█████▉                                                                                         | 82/1310 [25:14<6:41:37, 19.62s/it]
{'loss': 0.6243, 'learning_rate': 0.000328, 'epoch': 0.63}


  6%|██████                                                                                         | 84/1310 [25:39<5:29:10, 16.11s/it]

  6%|██████▏                                                                                        | 85/1310 [25:59<5:50:47, 17.18s/it]

  7%|██████▏                                                                                        | 86/1310 [26:15<5:42:17, 16.78s/it]

  7%|██████▎                                                                                        | 87/1310 [26:43<6:53:19, 20.28s/it]

  7%|██████▍                                                                                        | 88/1310 [27:00<6:33:42, 19.33s/it]

  7%|██████▍                                                                                        | 89/1310 [27:12<5:45:08, 16.96s/it]
{'loss': 0.6338, 'learning_rate': 0.00035600000000000003, 'epoch': 0.68}

  7%|██████▌                                                                                        | 90/1310 [27:28<5:44:01, 16.92s/it]








 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]


  7%|██████▌                                                                                        | 91/1310 [28:15<8:41:54, 25.69s/it]

  7%|██████▋                                                                                        | 92/1310 [28:28<7:26:53, 22.01s/it]

  7%|██████▋                                                                                        | 93/1310 [28:46<7:00:03, 20.71s/it]

  7%|██████▊                                                                                        | 94/1310 [29:04<6:44:46, 19.97s/it]

  7%|██████▉                                                                                        | 95/1310 [29:19<6:17:10, 18.63s/it]

  7%|██████▉                                                                                        | 96/1310 [29:37<6:10:44, 18.32s/it]

  7%|███████                                                                                        | 97/1310 [29:51<5:44:45, 17.05s/it]

  7%|███████                                                                                        | 98/1310 [30:12<6:06:59, 18.17s/it]

  8%|███████▏                                                                                       | 99/1310 [30:26<5:42:04, 16.95s/it]

  8%|███████▏                                                                                      | 100/1310 [30:39<5:18:06, 15.77s/it]
{'loss': 0.5639, 'learning_rate': 0.0004, 'epoch': 0.76}










 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]

  8%|███████▏                                                                                      | 101/1310 [31:16<7:25:36, 22.11s/it]

  8%|███████▎                                                                                      | 102/1310 [31:39<7:32:20, 22.47s/it]

  8%|███████▍                                                                                      | 103/1310 [32:01<7:25:12, 22.13s/it]

  8%|███████▍                                                                                      | 104/1310 [32:16<6:43:09, 20.06s/it]

  8%|███████▌                                                                                      | 105/1310 [32:36<6:41:45, 20.00s/it]

  8%|███████▌                                                                                      | 106/1310 [33:06<7:46:10, 23.23s/it]

  8%|███████▋                                                                                      | 107/1310 [33:19<6:41:33, 20.03s/it]

  8%|███████▋                                                                                      | 108/1310 [33:41<6:50:31, 20.49s/it]

  8%|███████▊                                                                                      | 109/1310 [33:57<6:23:50, 19.18s/it]

  8%|███████▉                                                                                      | 110/1310 [34:18<6:37:39, 19.88s/it]
{'loss': 0.5217, 'learning_rate': 0.0003999325930607025, 'epoch': 0.84}











 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]

  8%|███████▉                                                                                      | 111/1310 [34:57<8:33:27, 25.69s/it]

  9%|████████                                                                                      | 112/1310 [35:14<7:39:37, 23.02s/it]

  9%|████████                                                                                      | 113/1310 [35:34<7:20:53, 22.10s/it]

  9%|████████▏                                                                                     | 114/1310 [35:50<6:44:15, 20.28s/it]

  9%|████████▎                                                                                     | 115/1310 [36:08<6:28:30, 19.51s/it]

  9%|████████▎                                                                                     | 116/1310 [36:19<5:35:18, 16.85s/it]
{'loss': 0.5246, 'learning_rate': 0.0003998274533573062, 'epoch': 0.89}

  9%|████████▍                                                                                     | 117/1310 [36:33<5:23:12, 16.26s/it]

  9%|████████▍                                                                                     | 118/1310 [36:52<5:34:52, 16.86s/it]

  9%|████████▌                                                                                     | 119/1310 [37:09<5:37:13, 16.99s/it]

  9%|████████▌                                                                                     | 120/1310 [37:28<5:47:26, 17.52s/it]










 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]

{'eval_loss': 0.555648684501648, 'eval_runtime': 26.0918, 'eval_samples_per_second': 3.833, 'eval_steps_per_second': 0.498, 'epoch': 0.92}

  9%|████████▋                                                                                     | 121/1310 [38:18<9:03:35, 27.43s/it]

  9%|████████▊                                                                                     | 122/1310 [38:36<8:03:06, 24.40s/it]

  9%|████████▊                                                                                     | 123/1310 [38:51<7:08:54, 21.68s/it]

  9%|████████▉                                                                                     | 124/1310 [39:01<5:58:45, 18.15s/it]

 10%|████████▉                                                                                     | 125/1310 [39:14<5:31:10, 16.77s/it]

 10%|█████████                                                                                     | 126/1310 [39:27<5:03:52, 15.40s/it]

 10%|█████████                                                                                     | 127/1310 [39:48<5:39:30, 17.22s/it]

 10%|█████████▏                                                                                    | 128/1310 [40:02<5:16:46, 16.08s/it]

 10%|█████████▎                                                                                    | 129/1310 [40:23<5:49:39, 17.76s/it]

 10%|█████████▎                                                                                    | 130/1310 [40:40<5:45:58, 17.59s/it]










 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]

{'eval_loss': 0.5553188920021057, 'eval_runtime': 26.1005, 'eval_samples_per_second': 3.831, 'eval_steps_per_second': 0.498, 'epoch': 0.99}

 10%|█████████▍                                                                                    | 131/1310 [41:24<8:21:00, 25.50s/it]

 10%|█████████▍                                                                                    | 132/1310 [41:46<7:57:15, 24.31s/it]

 10%|█████████▌                                                                                    | 133/1310 [42:01<7:01:49, 21.50s/it]

 10%|█████████▌                                                                                    | 134/1310 [42:12<6:02:56, 18.52s/it]

 10%|█████████▋                                                                                    | 135/1310 [42:27<5:39:35, 17.34s/it]

 10%|█████████▊                                                                                    | 136/1310 [42:41<5:20:44, 16.39s/it]

 10%|█████████▊                                                                                    | 137/1310 [43:05<6:02:20, 18.53s/it]

 11%|█████████▉                                                                                    | 138/1310 [43:19<5:35:12, 17.16s/it]

 11%|█████████▉                                                                                    | 139/1310 [43:32<5:13:07, 16.04s/it]

 11%|██████████                                                                                    | 140/1310 [43:43<4:42:22, 14.48s/it]










 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]

{'eval_loss': 0.5619277954101562, 'eval_runtime': 26.0828, 'eval_samples_per_second': 3.834, 'eval_steps_per_second': 0.498, 'epoch': 1.07}

 11%|██████████                                                                                    | 141/1310 [44:31<7:56:08, 24.44s/it]

 11%|██████████▏                                                                                   | 142/1310 [44:45<6:58:40, 21.51s/it]

 11%|██████████▎                                                                                   | 143/1310 [45:13<7:37:20, 23.51s/it]

 11%|██████████▎                                                                                   | 144/1310 [45:28<6:47:16, 20.96s/it]

 11%|██████████▍                                                                                   | 145/1310 [45:43<6:11:22, 19.13s/it]

 11%|██████████▍                                                                                   | 146/1310 [45:57<5:39:13, 17.49s/it]

 11%|██████████▌                                                                                   | 147/1310 [46:11<5:21:10, 16.57s/it]

 11%|██████████▌                                                                                   | 148/1310 [46:27<5:13:43, 16.20s/it]

 11%|██████████▋                                                                                   | 149/1310 [46:59<6:49:29, 21.16s/it]

 11%|██████████▊                                                                                   | 150/1310 [47:19<6:41:58, 20.79s/it]










 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]

{'eval_loss': 0.5713925957679749, 'eval_runtime': 26.081, 'eval_samples_per_second': 3.834, 'eval_steps_per_second': 0.498, 'epoch': 1.15}

 12%|██████████▊                                                                                   | 151/1310 [47:57<8:18:40, 25.82s/it]

 12%|██████████▉                                                                                   | 152/1310 [48:11<7:09:31, 22.26s/it]


 12%|███████████                                                                                   | 154/1310 [48:52<6:59:40, 21.78s/it]
{'loss': 0.4232, 'learning_rate': 0.00039803752108910433, 'epoch': 1.18}

 12%|███████████                                                                                   | 155/1310 [49:06<6:16:40, 19.57s/it]

 12%|███████████▏                                                                                  | 156/1310 [49:21<5:45:38, 17.97s/it]

 12%|███████████▎                                                                                  | 157/1310 [49:47<6:34:06, 20.51s/it]

 12%|███████████▎                                                                                  | 158/1310 [50:06<6:27:17, 20.17s/it]

 12%|███████████▍                                                                                  | 159/1310 [50:30<6:48:18, 21.28s/it]

 12%|███████████▍                                                                                  | 160/1310 [50:50<6:41:50, 20.97s/it]








 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]

{'eval_loss': 0.5631969571113586, 'eval_runtime': 26.088, 'eval_samples_per_second': 3.833, 'eval_steps_per_second': 0.498, 'epoch': 1.22}

 12%|███████████▌                                                                                  | 161/1310 [51:35<8:56:00, 27.99s/it]

 12%|███████████▌                                                                                  | 162/1310 [51:50<7:39:51, 24.03s/it]

 12%|███████████▋                                                                                  | 163/1310 [52:08<7:05:21, 22.25s/it]

 13%|███████████▊                                                                                  | 164/1310 [52:25<6:35:44, 20.72s/it]

 13%|███████████▊                                                                                  | 165/1310 [52:36<5:43:15, 17.99s/it]

 13%|███████████▉                                                                                  | 166/1310 [52:49<5:11:41, 16.35s/it]

 13%|███████████▉                                                                                  | 167/1310 [53:07<5:23:23, 16.98s/it]

 13%|████████████                                                                                  | 168/1310 [53:22<5:11:49, 16.38s/it]

 13%|████████████▏                                                                                 | 169/1310 [53:50<6:13:28, 19.64s/it]

 13%|████████████▏                                                                                 | 170/1310 [54:01<5:24:22, 17.07s/it]









 92%|███████████████████████████████████████████████████████████████████████████████████████████▍       | 12/13 [00:22<00:02,  2.08s/it]

{'eval_loss': 0.5621181726455688, 'eval_runtime': 26.1003, 'eval_samples_per_second': 3.831, 'eval_steps_per_second': 0.498, 'epoch': 1.3}

 13%|████████████▎                                                                                 | 171/1310 [54:42<7:40:20, 24.25s/it]

 13%|████████████▎                                                                                 | 172/1310 [54:57<6:50:54, 21.67s/it]

 13%|████████████▍                                                                                 | 173/1310 [55:24<7:18:21, 23.13s/it]


 13%|████████████▌                                                                                 | 175/1310 [55:51<5:38:22, 17.89s/it]
{'loss': 0.5038, 'learning_rate': 0.0003962201133186241, 'epoch': 1.34}

 13%|████████████▋                                                                                 | 176/1310 [56:03<5:08:36, 16.33s/it]

 14%|████████████▋                                                                                 | 177/1310 [56:18<4:58:10, 15.79s/it]Traceback (most recent call last):
  File "/home/elicer/projects/Platypus/finetune.py", line 313, in <module>
    torch.cuda.empty_cache()
  File "/home/elicer/.local/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/elicer/.local/lib/python3.10/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/home/elicer/.local/lib/python3.10/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/home/elicer/projects/Platypus/finetune.py", line 302, in train
  File "/home/elicer/.local/lib/python3.10/site-packages/transformers/trainer.py", line 1537, in train
    return inner_training_loop(
  File "/home/elicer/.local/lib/python3.10/site-packages/transformers/trainer.py", line 1854, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/home/elicer/.local/lib/python3.10/site-packages/transformers/trainer.py", line 2737, in training_step
    self.accelerator.backward(loss)
  File "/home/elicer/.local/lib/python3.10/site-packages/accelerate/accelerator.py", line 1851, in backward
    self.scaler.scale(loss).backward(**kwargs)
  File "/home/elicer/.local/lib/python3.10/site-packages/torch/_tensor.py", line 492, in backward
    torch.autograd.backward(
  File "/home/elicer/.local/lib/python3.10/site-packages/torch/autograd/__init__.py", line 251, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt